https://gitlab.com/matthewmcneilly/aib-demo.git


# Pull dockerfile using git 

# List RHEL Release 
cat /etc/redhat-release

# Disable SELinux 
# yum install container-selinux -y 
# sestatus
# sudo sed -i 's/enforcing/disabled/g' /etc/selinux/config /etc/selinux/config
# cat /etc/selinux/config
# sestatus
# getenforce 

# Add Extra Repo
sudo subscription-manager repos --enable=rhel-7-server-extras-rpms
sudo yum repolist

# Install Podman Buildah
yum install podman -y
yum install buildah -y
podman --version
buildah --version 

# Inspect and Pull Remote Image 
skopeo inspect --creds=matthew.mcneilly@ammeon.com:b39gy9VgMy docker://registry.redhat.io/openjdk/openjdk-8-rhel8
podman pull --creds=matthew.mcneilly@ammeon.com:b39gy9VgMy docker://registry.redhat.io/openjdk/openjdk-8-rhel8
# Build New "Golden Image" 
podman build -f /var/lib/jenkins/workspace/AIB/rhel-openjdk-maven.dockerfile -t maven-openjdk1.8-rhel8
podman images


# Remove Existing Container 
buildah rm --all 
# Build Container from "Golden Image" 
buildah from --name "golden-image" localhost/maven-openjdk1.8-rhel8 
buildah containers
buildah run golden-image mvn -v
# buildah run --tty golden-image mvn -v



# Qualys Details 
https://qualysguard.qg2.apps.qualys.eu/
ammen5mm2
ZRsx6uD%
Amm3onS0lutions@2020


# Move Qualys Container 
sudo docker save qualys/sensor > qualys-sensor.tar
sudo podman load -i qualys-sensor.tar
sudo buildah from --name qualys-sensor localhost/qualys/sensor



# Kubeadm 
# Kubeadm install 
sudo apt-get update && sudo apt-get install -y apt-transport-https curl
curl -s https://packages.cloud.google.com/apt/doc/apt-key.gpg | sudo apt-key add -
cat <<EOF | sudo tee /etc/apt/sources.list.d/kubernetes.list
deb https://apt.kubernetes.io/ kubernetes-xenial main
EOF
sudo apt-get update
sudo apt-get install -y kubelet kubeadm kubectl
sudo apt-mark hold kubelet kubeadm kubectl

# Check kubectl version 
kubectl version 

# Setup control plane (master node) 
kubeadm init 
mkdir -p $HOME/.kube
sudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config
sudo chown $(id -u):$(id -g) $HOME/.kube/config
kubeadm token list 
openssl x509 -pubkey -in /etc/kubernetes/pki/ca.crt | openssl rsa -pubin -outform der 2>/dev/null | \
   openssl dgst -sha256 -hex | sed 's/^.* //'


kubeadm join 172.17.0.7:2073 --token qu2sv8.tgm8qwv7aa3zf0qs --discovery-token-ca-cert-hash sha256:5ee71a2c5b2cb79794e9368a6c182c386563041b6baeeda2a7a1f90d33a7ece6




